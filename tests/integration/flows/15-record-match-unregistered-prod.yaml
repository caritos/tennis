appId: host.exp.exponent
name: "PRODUCTION - Record Match with Unregistered Player"
---
# Production E2E test for recording match with unregistered player
# Uses production Supabase database and real club data
# 
# IMPORTANT: This test connects to PRODUCTION database
# - Uses real club data
# - Creates real match records
# - Test data will persist in production

- launchApp
- waitForAnimationToEnd:
    timeout: 10000

# Navigate through Expo Go to your project running on production
- assertVisible:
    text: "Recently opened|Enter URL manually"
    optional: true

# Connect to production tennis project
- tapOn:
    text: ".*tennis.*|.*Tennis.*|localhost.*8081"
    index: 0
    optional: true
- waitForAnimationToEnd:
    timeout: 15000

# Wait for production app to load (may take longer)
- assertVisible:
    text: "My Clubs|Sign In|Get Started|Tennis Club"
    timeout: 30000
- takeScreenshot: production-app-loaded

# PRODUCTION TEST SCENARIO:
# Test with realistic names and scenarios that could happen in production

# Navigate to clubs (handle different possible states)
- tapOn:
    text: "My Clubs"
    optional: true
- waitForAnimationToEnd

# Look for real clubs - production may have different club names
- assertVisible:
    text: ".*Club.*|.*Tennis.*|No clubs"
    optional: true

# If user has clubs, select the first one
- tapOn:
    text: ".*Club.*|.*Tennis.*"
    index: 0
    optional: true
- waitForAnimationToEnd:
    timeout: 5000

# If no clubs, this test documents the production state
- takeScreenshot: production-clubs-state

# Navigate to match recording (if club selected)
- assertVisible: 
    text: "Record Match"
    optional: true
- tapOn: 
    text: "Record Match"
    optional: true
- waitForAnimationToEnd
- takeScreenshot: production-match-form

# Test unregistered player flow with realistic production scenario
- tapOn: "Singles"
    optional: true
- waitForAnimationToEnd

# Production Test Case 1: Common guest player name
- tapOn:
    text: "Select Opponent"
    optional: true
- tapOn:
    id: "opponent-search-input"
    optional: true
- waitForAnimationToEnd

# Clear any existing text and enter realistic guest name
- longPressOn:
    id: "opponent-search-input"
    optional: true
- tapOn: 
    text: "Select All"
    optional: true
- eraseText
- inputText: "Jennifer Smith"
- waitForAnimationToEnd

# Verify unregistered player addition works in production
- assertVisible:
    text: "Add Jennifer Smith as unregistered player"
    optional: true
- tapOn:
    text: "Add Jennifer Smith as unregistered player"
    optional: true
- waitForAnimationToEnd
- takeScreenshot: production-unregistered-added

# Production Test Case 2: Realistic match score
# Test common recreational tennis scores
- tapOn:
    id: "player-score-input-0"
    optional: true
- inputText: "6"
- tapOn:
    id: "opponent-score-input-0" 
    optional: true
- inputText: "1"
- waitForAnimationToEnd

# Second set - closer score
- tapOn:
    id: "player-score-input-1"
    optional: true
- inputText: "7"
- tapOn:
    id: "opponent-score-input-1"
    optional: true
- inputText: "5"
- waitForAnimationToEnd
- takeScreenshot: production-scores-entered

# Production Test Case 3: Save with production database
# This creates a real record in production database
- tapOn: "Save Match"
    optional: true
- waitForAnimationToEnd:
    timeout: 15000  # Production may be slower

# Production Verification
- assertVisible:
    text: "Recent Matches|Club Rankings|Match saved"
    optional: true
- assertVisible:
    text: "Jennifer Smith"
    optional: true
- takeScreenshot: production-match-saved

# Production Test Case 4: Verify data persistence
# Check that match appears correctly in production club
- assertVisible: "Recent Matches"
    optional: true
- assertVisible:
    text: "6-1"
    optional: true
- assertVisible:
    text: "7-5"
    optional: true

# Navigate to profile to verify production match history
- tapOn: "Profile"
    optional: true
- waitForAnimationToEnd
- assertVisible: "Match History"
    optional: true
- tapOn: "Match History"
    optional: true
- waitForAnimationToEnd

# Verify match appears in production match history
- assertVisible:
    text: "Jennifer Smith"
    optional: true
- takeScreenshot: production-match-history

# Production Test Case 5: Test ELO rating update
# Verify that production ELO system processed the match
- assertVisible:
    text: "ELO|Rating"
    optional: true
- takeScreenshot: production-elo-updated

# Final production verification screenshot
- takeScreenshot: production-test-complete

# SUCCESS: Production E2E test completed
# - Tested real production database connection
# - Created actual match record with unregistered player
# - Verified production ELO rating system
# - Confirmed production UI flows work correctly
# - Documented production club and user state