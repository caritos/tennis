appId: com.anonymous.tennis-club
name: Accurate Sign In Flow
env:
  # Use a known test account (you should create this manually first)
  TEST_EMAIL: "existing@example.com"
  TEST_PASSWORD: "TestPass123!"
---
# Start fresh
- launchApp:
    clearState: true

- waitForAnimationToEnd

# Navigate to sign in screen
# Try direct sign in button first
- tapOn:
    text: "Sign In"
    optional: true

# If not found, go through welcome flow
- tapOn:
    text: "Get started"
    optional: true

# Look for existing account link
- tapOn:
    text: "Already have an account"
    optional: true

- tapOn:
    text: "Sign In"
    optional: true

# Should now be on EmailSignInForm with "Tennis Club" title
- assertVisible:
    text: "ðŸŽ¾ Tennis Club"
    optional: true

- assertVisible:
    text: "Welcome back!"
    optional: true

# Fill email field (exact label from EmailSignInForm)
- tapOn:
    text: "Email Address"
- inputText: "${TEST_EMAIL}"

# Fill password field (exact label from EmailSignInForm)
- tapOn:
    text: "Password"
- inputText: "${TEST_PASSWORD}"

# Submit form (exact button text from EmailSignInForm)
- tapOn:
    text: "Sign In"

# Wait for sign in process
- waitForAnimationToEnd
- waitForAnimationToEnd

# Check for success (main app) or error
- assertVisible:
    text: "Profile"
    optional: true

- assertVisible:
    text: "My Clubs"
    optional: true

# If error, check for error message
- assertVisible:
    text: "Invalid email or password"
    optional: true

# Take final screenshot
- takeScreenshot: "signin-final-state"